---
export const prerender = false;
import Layout from "../../layouts/Layout.astro";
import Footer from "../../components/Footer.astro";
import { getAllPublishedPosts } from "../../lib/blog";

const posts = await getAllPublishedPosts();
---

<Layout
  title="Blog | SarvaSEO"
  description="SEO insights, strategies, and guides from SarvaSEO. Learn how to improve your search engine rankings with actionable tips."
  canonicalUrl="https://sarvaseo.atrey.dev/blog"
  ogType="website"
>
  <main class="max-w-3xl mx-auto px-6 pt-16 pb-6">
    <div class="mb-12">
      <h1 class="font-instrument text-4xl sm:text-5xl text-gray-900 font-light mb-3">
        <span class="bg-gradient-to-r from-amber-700 via-yellow-600 to-amber-700 bg-clip-text text-transparent">Blog</span>
      </h1>
      <p class="text-sm text-gray-500">SEO insights, strategies, and actionable guides.</p>
    </div>

    {posts.length === 0 ? (
      <p class="text-sm text-gray-400 italic">No posts yet. Check back soon.</p>
    ) : (
      <div class="space-y-6">
        {posts.map((post) => (
          <a href={`/blog/${post.slug}`} class="block group">
            <article class="flex flex-col sm:flex-row gap-4 sm:gap-5 py-3">
              {post.coverImage && (
                <img
                  src={post.coverImage}
                  alt={post.title}
                  class="w-full sm:w-64 h-44 sm:h-36 object-cover rounded-md sm:shrink-0"
                  width="256"
                  height="144"
                  loading="lazy"
                />
              )}
              <div class="min-w-0">
                <h2 class="font-instrument text-xl text-gray-900 group-hover:text-yellow-700 transition-colors duration-200">
                  {post.title}
                </h2>
                {post.excerpt && (
                  <p class="text-sm text-gray-500 mt-1 line-clamp-2">{post.excerpt}</p>
                )}
                <div class="flex flex-wrap items-center gap-x-3 gap-y-1 mt-2 text-xs text-gray-400">
                  <span>{post.author}</span>
                  <span>&middot;</span>
                  <time datetime={post.createdAt?.toDate?.().toISOString?.() || ""}>
                    {post.createdAt?.toDate?.().toLocaleDateString("en-US", {
                      year: "numeric",
                      month: "long",
                      day: "numeric",
                    }) || ""}
                  </time>
                  {post.tags?.length > 0 && (
                    <>
                      <span>&middot;</span>
                      <span>{post.tags.join(", ")}</span>
                    </>
                  )}
                </div>
              </div>
            </article>
          </a>
        ))}
      </div>
    )}

    <div class="mt-12 pt-6 border-t border-gray-100">
      <a href="/" class="text-sm text-gray-500 hover:text-gray-700 underline">&larr; Back to SarvaSEO</a>
    </div>
  </main>
  <Footer />
</Layout>
